<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Android Gradle Kts 配置</title>
    <url>/2020/11/19/android-gradle-kts.html</url>
    <content><![CDATA[<h2 id="Android项目使用KTS进行构建"><a href="#Android项目使用KTS进行构建" class="headerlink" title="Android项目使用KTS进行构建"></a>Android项目使用KTS进行构建</h2><h3 id="项目配置文件"><a href="#项目配置文件" class="headerlink" title="项目配置文件"></a>项目配置文件</h3><p><strong>settings.gradle.kts</strong></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">include(<span class="string">&quot;:app&quot;</span>, <span class="string">&quot;:common&quot;</span>)</span><br><span class="line">rootProject.name = <span class="string">&quot;bootstrap&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>build.gradle.kts</strong></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath(<span class="string">&quot;com.android.tools.build:gradle:4.1.1&quot;</span>)</span><br><span class="line">        classpath(kotlin(<span class="string">&quot;gradle-plugin&quot;</span>, version = <span class="string">&quot;1.4.10&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        google()</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tasks.register(<span class="string">&quot;clean&quot;</span>, Delete::<span class="class"><span class="keyword">class</span>) </span>&#123;</span><br><span class="line">    delete(rootProject.buildDir)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>app/build.gradle.kts</strong></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.jetbrains.kotlin.config.KotlinCompilerVersion</span><br><span class="line"></span><br><span class="line">plugins &#123;</span><br><span class="line">    id(<span class="string">&quot;com.android.application&quot;</span>)</span><br><span class="line">    kotlin(<span class="string">&quot;android&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion(<span class="number">30</span>)</span><br><span class="line">    buildToolsVersion(<span class="string">&quot;30.0.2&quot;</span>)</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId = <span class="string">&quot;io.github.thisdk.bootstrap&quot;</span></span><br><span class="line">        minSdkVersion(<span class="number">21</span>)</span><br><span class="line">        targetSdkVersion(<span class="number">30</span>)</span><br><span class="line">        versionCode = <span class="number">1</span></span><br><span class="line">        versionName = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        create(<span class="string">&quot;release&quot;</span>) &#123;</span><br><span class="line">            storeFile = file(<span class="string">&quot;../bootstrap.jks&quot;</span>)</span><br><span class="line">            storePassword = <span class="string">&quot;bootstrap&quot;</span></span><br><span class="line">            keyAlias = <span class="string">&quot;bootstrap&quot;</span></span><br><span class="line">            keyPassword = <span class="string">&quot;bootstrap&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        getByName(<span class="string">&quot;debug&quot;</span>) &#123;</span><br><span class="line">            isMinifyEnabled = <span class="literal">false</span></span><br><span class="line">            proguardFiles(</span><br><span class="line">                getDefaultProguardFile(<span class="string">&quot;proguard-android-optimize.txt&quot;</span>),</span><br><span class="line">                <span class="string">&quot;proguard-rules.pro&quot;</span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        getByName(<span class="string">&quot;release&quot;</span>) &#123;</span><br><span class="line">            isMinifyEnabled = <span class="literal">true</span></span><br><span class="line">            isShrinkResources = <span class="literal">true</span></span><br><span class="line">            signingConfig = signingConfigs.getByName(<span class="string">&quot;release&quot;</span>)</span><br><span class="line">            proguardFiles(</span><br><span class="line">                getDefaultProguardFile(<span class="string">&quot;proguard-android-optimize.txt&quot;</span>),</span><br><span class="line">                <span class="string">&quot;proguard-rules.pro&quot;</span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        sourceCompatibility = JavaVersion.VERSION_1_8</span><br><span class="line">        targetCompatibility = JavaVersion.VERSION_1_8</span><br><span class="line">    &#125;</span><br><span class="line">    kotlinOptions &#123;</span><br><span class="line">        jvmTarget = <span class="string">&quot;1.8&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    implementation(kotlin(<span class="string">&quot;stdlib-jdk8&quot;</span>, KotlinCompilerVersion.VERSION))</span><br><span class="line"></span><br><span class="line">    implementation(<span class="string">&quot;androidx.appcompat:appcompat:1.2.0&quot;</span>)</span><br><span class="line"></span><br><span class="line">    implementation(<span class="string">&quot;androidx.constraintlayout:constraintlayout:2.0.4&quot;</span>)</span><br><span class="line">    implementation(<span class="string">&quot;com.google.android.material:material:1.2.1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    implementation(<span class="string">&quot;com.squareup.okhttp3:okhttp:4.9.0&quot;</span>)</span><br><span class="line"></span><br><span class="line">    implementation(project(<span class="string">&quot;:common&quot;</span>))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>common/build.gradle.kts</strong></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.jetbrains.kotlin.config.KotlinCompilerVersion</span><br><span class="line"></span><br><span class="line">plugins &#123;</span><br><span class="line">    id(<span class="string">&quot;com.android.library&quot;</span>)</span><br><span class="line">    kotlin(<span class="string">&quot;android&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion(<span class="number">30</span>)</span><br><span class="line">    buildToolsVersion(<span class="string">&quot;30.0.2&quot;</span>)</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        minSdkVersion(<span class="number">21</span>)</span><br><span class="line">        targetSdkVersion(<span class="number">30</span>)</span><br><span class="line">        versionCode = <span class="number">1</span></span><br><span class="line">        versionName = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line">        consumerProguardFiles(<span class="string">&quot;consumer-rules.pro&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        getByName(<span class="string">&quot;debug&quot;</span>) &#123;</span><br><span class="line">            isMinifyEnabled = <span class="literal">false</span></span><br><span class="line">            proguardFiles(</span><br><span class="line">                getDefaultProguardFile(<span class="string">&quot;proguard-android-optimize.txt&quot;</span>),</span><br><span class="line">                <span class="string">&quot;proguard-rules.pro&quot;</span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        getByName(<span class="string">&quot;release&quot;</span>) &#123;</span><br><span class="line">            isMinifyEnabled = <span class="literal">true</span></span><br><span class="line">            proguardFiles(</span><br><span class="line">                getDefaultProguardFile(<span class="string">&quot;proguard-android-optimize.txt&quot;</span>),</span><br><span class="line">                <span class="string">&quot;proguard-rules.pro&quot;</span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    compileOptions &#123;</span><br><span class="line">        sourceCompatibility = JavaVersion.VERSION_1_8</span><br><span class="line">        targetCompatibility = JavaVersion.VERSION_1_8</span><br><span class="line">    &#125;</span><br><span class="line">    kotlinOptions &#123;</span><br><span class="line">        jvmTarget = <span class="string">&quot;1.8&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    implementation(kotlin(<span class="string">&quot;stdlib-jdk8&quot;</span>, KotlinCompilerVersion.VERSION))</span><br><span class="line"></span><br><span class="line">    api(<span class="string">&quot;androidx.core:core-ktx:1.3.2&quot;</span>)</span><br><span class="line"></span><br><span class="line">    api(<span class="string">&quot;androidx.lifecycle:lifecycle-common-java8:2.2.0&quot;</span>)</span><br><span class="line">    api(<span class="string">&quot;androidx.lifecycle:lifecycle-livedata:2.2.0&quot;</span>)</span><br><span class="line">    api(<span class="string">&quot;androidx.lifecycle:lifecycle-viewmodel:2.2.0&quot;</span>)</span><br><span class="line"></span><br><span class="line">    api(<span class="string">&quot;androidx.navigation:navigation-ui-ktx:2.3.1&quot;</span>)</span><br><span class="line">    api(<span class="string">&quot;androidx.navigation:navigation-fragment-ktx:2.3.1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    api(<span class="string">&quot;com.blankj:utilcodex:1.30.5&quot;</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>配置</category>
      </categories>
      <tags>
        <tag>配置</tag>
      </tags>
  </entry>
  <entry>
    <title>Android 开发环境</title>
    <url>/2020/11/18/android-env-config.html</url>
    <content><![CDATA[<h3 id="记录安装开发环境的配置"><a href="#记录安装开发环境的配置" class="headerlink" title="记录安装开发环境的配置"></a>记录安装开发环境的配置</h3><p>其实如果一个项目被Android Studio打开.是不需要配置任何环境变量都能被正确编译的</p>
<p>但是我们需要的不仅仅是这样</p>
<p>下载SDK与开发工具的位置</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">D:\Android\Android Studio</span><br><span class="line">D:\Android\SDK</span><br><span class="line">D:\Android\Home</span><br><span class="line">D:\Android\Flutter</span><br><span class="line">D:\Android\Gradle</span><br></pre></td></tr></table></figure>

<h3 id="Java环境配置"><a href="#Java环境配置" class="headerlink" title="Java环境配置"></a>Java环境配置</h3><p>这个时候我们可以使用Android Studio自带的JDK与JRE</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">JAVA_HOME&#x3D;D:\Android\Android Studio\jre</span><br><span class="line">JRE_HOME&#x3D;D:\Android\Android Studio\jre\jre</span><br><span class="line">CLASSPATH&#x3D;.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar</span><br></pre></td></tr></table></figure>

<h3 id="Android环境配置"><a href="#Android环境配置" class="headerlink" title="Android环境配置"></a>Android环境配置</h3><p>配置好Android SDK的位置.</p>
<blockquote>
<p>配置GRADLE_USER_HOME的原因是因为我想控制gradle的缓存位置</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Android_SDK_HOME&#x3D;D:\Android\Home</span><br><span class="line">ANDROID_HOME&#x3D;D:\Android\SDK</span><br><span class="line">ANDROID_SDK_ROOT&#x3D;%ANDROID_HOME%</span><br><span class="line">GRADLE_USER_HOME&#x3D;D:\Android\Gradle</span><br></pre></td></tr></table></figure>

<h3 id="Flutter环境变量"><a href="#Flutter环境变量" class="headerlink" title="Flutter环境变量"></a>Flutter环境变量</h3><p>若顺便进行Flutter</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">FLUTTER_HOME&#x3D;D:\Android\Flutter</span><br><span class="line">FLUTTER_STORAGE_BASE_URL&#x3D;https:&#x2F;&#x2F;storage.flutter-io.cn</span><br><span class="line">PUB_HOSTED_URL&#x3D;https:&#x2F;&#x2F;pub.flutter-io.cn</span><br></pre></td></tr></table></figure>


<h3 id="PATH"><a href="#PATH" class="headerlink" title="PATH"></a>PATH</h3><p>加入到PATH,方便命令行可以调用</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">%JAVA_HOME%\bin</span><br><span class="line">%JRE_HOME%\bin</span><br><span class="line">%ANDROID_HOME%\platform-tools</span><br><span class="line">%FLUTTER_HOME%\bin</span><br></pre></td></tr></table></figure>

<h3 id="Gradle-下载代理"><a href="#Gradle-下载代理" class="headerlink" title="Gradle 下载代理"></a>Gradle 下载代理</h3><blockquote>
<p>D:\Android\Gradle\gradle.properties</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">systemProp.http.proxyHost&#x3D;127.0.0.1</span><br><span class="line">systemProp.http.proxyPort&#x3D;1080</span><br><span class="line">systemProp.https.proxyHost&#x3D;127.0.0.1</span><br><span class="line">systemProp.https.proxyPort&#x3D;1080</span><br></pre></td></tr></table></figure>

<h3 id="完成"><a href="#完成" class="headerlink" title="完成"></a>完成</h3><p>经过以上配置.任意一个Android项目下载到本地,不需要Android Studio打开.</p>
<p>可以直接通过gradlew assembelDebug直接进行编译.在只想运行一下别人项目的时候十分便捷.</p>
]]></content>
      <categories>
        <category>默认</category>
      </categories>
      <tags>
        <tag>默认</tag>
      </tags>
  </entry>
</search>
